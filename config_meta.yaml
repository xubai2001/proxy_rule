mixed-port: 7890
tproxy-port: 7893
allow-lan: true
mode: rule
log-level: info
external-controller: 127.0.0.1:9090
dns:
  enable: true
  ipv6: false
  use-hosts: true
  enhanced-mode: fake-ip
  listen: 127.0.0.1:53
  nameserver:
  - https://doh.pub/dns-query
  - 114.114.114.114
  - 119.29.29.29
  fake-ip-ranger: 198.18.0.1/16
  fallback:
  - https://1.1.1.1/dns-query
  - tls://1.0.0.1/dns-query
  - tls://8.8.8.8:853
  - 8.8.4.4
  fake-ip-filter:
  - '*.lan'
  - localhost.ptlogin2.qq.com
  - 172.16.154.130
  fallback-filter:
    geoip: true
    geosite:
      - gfw
    geoip-code: CN
    ipcidr:
      - 240.0.0.0/4
      - 120.232.192.250
    domain:
      - '+.google.com'
      - '+.youtube.com'

iptables:
  enable: true
  inbound-interface: wlo1


# Enable the TUN listener
# tun:
#   enable: true
#   stack: gvisor #  only gvisor
#   dns-hijack:
#     - 0.0.0.0:53 # additional dns server listen on TUN
#   auto-route: true # auto set global route

p: &p
  type: http
  interval: 3600
  health-check:
    enable: true
    url: http://www.gstatic.com/generate_204
    interval: 300

c: &rule-classical
  type: http
  behavior: classical
  interval: 86400

proxies:
  - name: GLaDOS-D1-00
    server: server
    port: port
    type: vless
    uuid: uuid
    tls: true
    servername: n2.gladns.com
    skip-cert-verify: false
    udp: true

  - name: GLaDOS-D1-01
    server: server
    port: port
    type: vless
    uuid: uuid
    tls: true
    servername: n2.gladns.com
    skip-cert-verify: false
    udp: true

proxy-providers:
  glados:
    <<: *p
    path: ./proxies/glados.yaml
    url: url

  okz2:
    <<: *p
    path: ./proxies/okz2.yaml
    url: url
    headers: "User-Agent:ClashForWindows"

rule-providers:
  bilibili:
    <<: *rule-classical
    url: https://raw.githubusercontent.com/xubai2001/proxy_rule/master/Bilibili.yaml
    path: ./ruleset/bilibili.yaml

  YouTube:
    <<: *rule-classical
    url: https://raw.githubusercontent.com/ACL4SSR/ACL4SSR/master/Clash/Providers/Ruleset/YouTube.yaml
    path: ./ruleset/YouTube.yaml

  Telegram:
    <<: *rule-classical
    url: https://raw.githubusercontent.com/ACL4SSR/ACL4SSR/master/Clash/Providers/Ruleset/Telegram.yaml
    path: ./ruleset/Telegram.yaml

  custom_direct:
    <<: *rule-classical
    url: https://raw.githubusercontent.com/xubai2001/proxy_rule/master/direct.yaml
    path: ./ruleset/custom_direct.yaml

  custom_proxy:
    <<: *rule-classical
    url: https://raw.githubusercontent.com/xubai2001/proxy_rule/master/proxy.yaml
    path: ./ruleset/custom_proxy.yaml

g: &no_cn
  proxies:
    - 🚀 节点选择
    - ♻️ 自动选择
    - 🇸🇬 狮城节点
    - 🇭🇰 香港节点
    - 🇨🇳 台湾节点
    - 🇯🇵 日本节点
    - 🇺🇲 美国节点
    - 🇰🇷 韩国节点
    - 🚀 手动切换

f: &add_cn
  proxies:
    - 🚀 节点选择
    - ♻️ 自动选择
    - 🇸🇬 狮城节点
    - 🇭🇰 香港节点
    - 🇨🇳 台湾节点
    - 🇯🇵 日本节点
    - 🇺🇲 美国节点
    - 🇰🇷 韩国节点
    - 🚀 手动切换
    - 🎯 全球直连

proxy-groups:
  - name: 🚀 节点选择
    type: select
    proxies:
    - ♻️ 自动选择
    - 🇭🇰 香港节点
    - 🇨🇳 台湾节点
    - 🇸🇬 狮城节点
    - 🇯🇵 日本节点
    - 🇺🇲 美国节点
    - 🇰🇷 韩国节点
    - 🚀 手动切换

  - name: 🚀 手动切换
    type: select
    use:
      - glados
      - okz2
    proxies:
      - DIRECT
      - GLaDOS-D1-00
      - GLaDOS-D1-01

  - name: ♻️ 自动选择
    type: url-test
    url: http://www.gstatic.com/generate_204
    interval: 300
    use:
      - glados
      - okz2
    filter: "GLaDOS-N2|香港"

  - name: 🎯 全球直连
    type: select
    proxies:
    - DIRECT
    - 🚀 节点选择
    - ♻️ 自动选择

  - name: 🐟 漏网之鱼
    type: select
    <<: *add_cn

  - name: 📲 电报消息
    type: select
    <<: *no_cn

  - name: 📹 油管视频
    type: select
    <<: *no_cn

  - name: 📺 哔哩哔哩
    type: select
    proxies:
    - 🎯 全球直连
    - 🇨🇳 台湾节点
    - 🇭🇰 香港节点

  - name: Ⓜ️ 微软云盘
    type: select
    <<: *add_cn

  - name: Ⓜ️ 微软服务
    type: select
    proxies:
    - Ⓜ️ 微软云盘

  - name: 🎥 奈飞视频
    type: select
    proxies:
    - 🎥 奈飞节点

  - name: 🛑 广告拦截
    type: select
    proxies:
    - REJECT
    - DIRECT

  - name: 🇭🇰 香港节点
    type: select
    use:
        - glados
        - okz2
    filter: "HK|香港|港"

  - name: 🇯🇵 日本节点
    type: url-test
    url: http://www.gstatic.com/generate_204
    interval: 300
    use:
      - glados
      - okz2
    filter: "JP|日本"

  - name: 🇨🇳 台湾节点
    type: select
    use:
      - glados
      - okz2
    filter: "TW|台湾|tw"

  - name: 🇸🇬 狮城节点
    type: url-test
    url: http://www.gstatic.com/generate_204
    interval: 300
    use:
      - glados
      - okz2
    filter: "SG|新加坡"

  - name: 🇺🇲 美国节点
    type: url-test
    url: http://www.gstatic.com/generate_204
    interval: 300
    use:
      - glados
      - okz2
    filter: "US|美国|西雅图|美國"

  - name: 🇰🇷 韩国节点
    type: url-test
    url: http://www.gstatic.com/generate_204
    interval: 300
    use:
      - glados
      - okz2
    filter: "韩国|春川"

  - name: 🎥 奈飞节点
    type: select
    use:
      - glados
      - okz2
    filter: "Netfilix|Netflix|奈飞"

rules:
  - RULE-SET, custom_proxy, 🚀 节点选择
  - RULE-SET, custom_direct, 🎯 全球直连
  - GEOSITE, bilibili, 📺 哔哩哔哩
  - GEOSITE, youtube, 📹 油管视频
  - RULE-SET, Telegram, 📲 电报消息
  - GEOSITE,category-ads-all,🛑 广告拦截
  - GEOSITE,geolocation-cn, 🎯 全球直连
  - GEOSITE,geolocation-!cn, 🚀 节点选择
  - GEOIP, CN, 🎯 全球直连
  - MATCH, 🐟 漏网之鱼
